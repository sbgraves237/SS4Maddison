---
title: "UpdateMaddisonData"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{UpdateMaddisonData}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(SS4Maddison)
```

## Intro 

This vignette describes how to download the latest Maddison Project data and create from it three data sets included in the package `SS4Maddison`: `MaddisonData`, `MaddisonCountries`, and `MaddisonRefs`. 

The Wikipedia article on the [Maddison Project](https://en.wikipedia.org/wiki/Maddison_Project) says, "Development economist Branko MilanoviÄ‡ (writing for the World Bank), development economist Morten Jerven, and billionaire philanthropist Bill Gates have identified the Maddison Project, the Penn World Tables, and World Bank/IMF data (the World Development Indicators), as the three main sources of worldwide economic statistics such as GDP data, with the focus of the Maddison Project being on historical data. Economist Paul Krugman has suggested the Maddison Project as a data source for historical debt, growth, and labor output and productivity data."  

Bolt and van Zanden (2020) say that, "The Maddison database on Historical Statistics of the World Economy has probably the widest coverage of data on GDP per capita across countries and over time currently available ... . To compare income levels and developments for this period and set of countries, national income estimates are converted ... to a common currency using purchasing power parities (PPPs)." 

## Get the data

The web site for [Maddison project data](https://www.rug.nl/ggdc/historicaldevelopment/maddison/) offers both "Angus Maddison's unaltered final dataset" and the "Latest Maddison Project Release".

On 2025-08-28 I saw that the "Latest Maddison Project Release" was dated 2024-09-18. I requested that and found that it was available in either Excel or Stata format. I downloaded the Excel format to my current working directory as `mpd2023web.xlsx`. (On 2025-08-28 I found a 4 MB file by this name dated 2025-06-03. I changed that name to `mpd023web0.xlsx` and downloaded ostensibly the same file and got one with 4.9 MB. I doubt if I would have deleted some of the content of the file with date 2025-06-03, though that's possible. In any event, I plan to ignore this difference.) 

In 2024, I also downloaded ["Maddison Database 2010"](https://www.rug.nl/ggdc/historicaldevelopment/maddison/releases/maddison-database-2010) and compared it with `mpd2020.xlsx`. I compared the two for numbers for the former USSR, the UK, and the US. I found that the newer data had many numbers the older data didn't while the older data had a few numbers absent from the newer data. However, it seemed that I would be wise to ignore the older data. 

## Find the data file

```{r findData}
(SS4xlsx <- path_package2('^mpd2023.*xlsx$'))
```

If more than one file was found, pick the most recent one. 

```{r whichSS4xlsx}
if(length(SS4xlsx)>1){
  MadInfo <- file.info(SS4xlsx)
  cat('Multiple files found.\n')
  print(MadInfo)
  imax <- which.max(MadInfo$mtime)
  SS4xlsx <- SS4xlsx[imax]
}
```

## Read the data file

Now read `SS4xlsx`. 

```{r readMaddison}
if(length(SS4xlsx)>0){
  MaddisonSources <- readxl::read_xlsx(SS4xlsx, sheet='Sources')
  MaddisonData <- readxl::read_xlsx(SS4xlsx, sheet='Full data')
}